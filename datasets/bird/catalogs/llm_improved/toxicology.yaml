---
type: header
schema_version: '1'
...
---
schema: public
name: atom
type: table
description: Each record represents an individual atom within a molecule, including
  its unique ID, parent molecule and chemical element symbol.
columns:
- name: atom_id
  description: Unique identifier for the atom.
- name: molecule_id
  description: Identifier of the molecule to which the atom belongs.
- name: element
  description: Chemical element symbol (e.g., C, Cl) for the atom.
...
---
schema: public
name: bond
type: table
description: Each record represents a chemical bond within a molecule, detailing its
  unique ID, parent molecule and bond type.
columns:
- name: bond_id
  description: Unique identifier for the bond, often encoding the connected atom IDs.
- name: molecule_id
  description: Identifier of the molecule in which the bond occurs.
- name: bond_type
  description: Symbol or code indicating the bond type (e.g., single '-', double '=')
...
---
schema: public
name: connected
type: table
description: This table lists pairs of atoms that are connected by a specific bond
  within a molecule.
columns:
- name: atom_id
  description: Identifier of the first atom in the connection.
- name: atom_id2
  description: Identifier of the second atom in the connection.
- name: bond_id
  description: Identifier of the bond that links the two atoms.
...
---
schema: public
name: molecule
type: table
description: Each record defines a molecule with its unique identifier and a label
  attribute.
columns:
- name: molecule_id
  description: Unique identifier for the molecule.
- name: label
  description: Optional label or property associated with the molecule (e.g., '+' for carcinogenic, '-' for non-carcinogenic).
...
---
type: fact
description: |
  For "average number of X atoms in Y molecules", first group by molecule_id to count X atoms per molecule, then calculate AVG() of those counts. Don't calculate overall averages across all atoms.
...
---
type: fact
description: |
  When listing elements or labels for a specific molecule, use DISTINCT to avoid duplicate entries since molecules can have multiple atoms of the same element.
...
---
type: sql_example
sql: |
  SELECT AVG(element_count) 
  FROM (
    SELECT a.molecule_id, COUNT(a.element) AS element_count
    FROM atom a
    JOIN bond b ON a.molecule_id = b.molecule_id
    WHERE b.bond_type = '-' AND a.element = 'o'
    GROUP BY a.molecule_id
  ) AS subquery
description: Calculate average number of specific atoms per molecule. Group by molecule first, then average the per-molecule counts.
...
---
type: sql_example
sql: |
  SELECT DISTINCT a.element, m.label
  FROM atom a
  JOIN molecule m ON a.molecule_id = m.molecule_id
  WHERE m.molecule_id = 'TR060'
description: Use DISTINCT when listing elements and properties for a specific molecule to avoid duplicates.
...
