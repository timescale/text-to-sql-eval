---
type: header
schema_version: '1'
...
---
schema: public
name: customers
type: table
description: Stores each customer along with their market segment and preferred currency.
facts:
  - Join with yearmonth table using customers.customerid = yearmonth.customerid for consumption data
  - Currency field values include 'CZK' and 'EUR' for Czech and Euro customers
  - Segment field contains values like 'SME', 'LAM' for business classifications
sql_examples:
  - description: Get customers by currency
    sql: "SELECT * FROM customers WHERE currency = 'EUR'"
  - description: Join customers with consumption data
    sql: "SELECT c.*, y.consumption FROM customers c JOIN yearmonth y ON c.customerid = y.customerid"
columns:
- name: customerid
  description: Unique identifier for the customer.
- name: segment
  description: Business segment classification of the customer (e.g., SME, LAM).
- name: currency
  description: Currency code typically used by the customer.
...
---
schema: public
name: gasstations
type: table
description: Lists gas stations with their chain affiliation, country, and market
  segment category.
facts:
  - "Country field uses country codes: 'CZE' for Czech Republic, 'SVK' for Slovakia"
  - Segment field contains values like 'Discount' for gas station positioning
  - Join with transactions_1k using gasstations.gasstationid = transactions_1k.gasstationid
sql_examples:
  - description: Count discount stations by country
    sql: "SELECT country, COUNT(*) FROM gasstations WHERE segment = 'Discount' GROUP BY country"
  - description: Calculate difference in discount stations between countries
    sql: "SELECT SUM(CASE WHEN country = 'CZE' THEN 1 ELSE 0 END) - SUM(CASE WHEN country = 'SVK' THEN 1 ELSE 0 END) FROM gasstations WHERE segment = 'Discount'"
columns:
- name: gasstationid
  description: Unique identifier for the gas station.
- name: chainid
  description: Identifier of the chain to which the gas station belongs.
- name: country
  description: Country where the gas station is located.
- name: segment
  description: Positioning segment of the gas station, such as premium or value.
...
---
schema: public
name: products
type: table
description: Catalog of products sold, mapping a product ID to its description.
columns:
- name: productid
  description: Unique identifier for the product.
- name: description
  description: Textual description or name of the product.
...
---
schema: public
name: transactions_1k
type: table
description: Holds individual fuel purchase transactions including date/time, customer,
  station, product, amount and price.
facts:
  - Date field uses standard date format (YYYY-MM-DD)
  - Join with yearmonth table for monthly consumption filtering
  - Join with customers, gasstations, and products for complete transaction details
  - For percentage calculations, count customers who made transactions on specific dates
sql_examples:
  - description: Get transactions by date
    sql: "SELECT * FROM transactions_1k WHERE date = '2012-08-25'"
  - description: Get transactions in Czech Republic
    sql: "SELECT t.* FROM transactions_1k t JOIN gasstations g ON t.gasstationid = g.gasstationid WHERE g.country = 'CZE'"
  - description: Calculate percentage of EUR customers on specific date
    sql: "SELECT CAST(SUM(CASE WHEN c.currency = 'EUR' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(t.customerid), 0) FROM transactions_1k t JOIN customers c ON t.customerid = c.customerid WHERE t.date = '2012-08-25'"
columns:
- name: transactionid
  description: Unique identifier for each transaction.
- name: date
  description: Calendar date when the transaction occurred.
- name: time
  description: Time of day the transaction was made.
- name: customerid
  description: Identifier of the customer who made the purchase.
- name: cardid
  description: Identifier of the payment or loyalty card used.
- name: gasstationid
  description: Identifier of the gas station where the purchase occurred.
- name: productid
  description: Identifier of the product purchased during the transaction.
- name: amount
  description: Quantity of product purchased, likely in liters.
- name: price
  description: Total price paid for the transaction.
...
---
schema: public
name: yearmonth
type: table
description: Summarizes monthly fuel consumption per customer.
facts:
  - Date field uses YYYYMM format (e.g., '201309' for September 2013)
  - Extract year using SUBSTR(date, 1, 4) and month using SUBSTR(date, 5, 2)
  - Always CAST consumption AS float for arithmetic calculations
  - Join with customers table using yearmonth.customerid = customers.customerid
  - For monthly aggregations, GROUP BY SUBSTR(date, 5, 2) for month grouping
sql_examples:
  - description: Filter by year 2012
    sql: "SELECT * FROM yearmonth WHERE SUBSTR(date, 1, 4) = '2012'"
  - description: Get consumption by month in 2013
    sql: "SELECT SUBSTR(date, 5, 2) as month, SUM(CAST(consumption AS float)) FROM yearmonth WHERE SUBSTR(date, 1, 4) = '2013' GROUP BY SUBSTR(date, 5, 2)"
  - description: Filter by specific month (September 2013)
    sql: "SELECT * FROM yearmonth WHERE date = '201309'"
  - description: Calculate consumption difference by currency
    sql: "SELECT SUM(CASE WHEN c.currency = 'CZK' THEN CAST(y.consumption AS float) ELSE 0 END) - SUM(CASE WHEN c.currency = 'EUR' THEN CAST(y.consumption AS float) ELSE 0 END) FROM customers c JOIN yearmonth y ON c.customerid = y.customerid WHERE SUBSTR(y.date, 1, 4) = '2012'"
columns:
- name: customerid
  description: Identifier of the customer for the consumption summary.
- name: date
  description: Year-month key (YYYYMM) representing the period of the consumption
    summary.
- name: consumption
  description: Total fuel consumption for the customer during the specified month.
...
