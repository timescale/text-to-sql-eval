{
    "database": "postgres_air",
    "question": "What is the average connecting time between flights for passengers traveling from Asia to South America?",
    "query": "WITH journey_bounds AS (\n  SELECT booking_id,\n         MIN(leg_num) AS min_leg,\n         MAX(leg_num) AS max_leg\n  FROM postgres_air.booking_leg\n  GROUP BY booking_id\n),\nfirst_last AS (\n  SELECT jb.booking_id,\n         f_dep.departure_airport,\n         f_arr.arrival_airport\n  FROM journey_bounds jb\n  JOIN postgres_air.booking_leg bl_dep ON jb.booking_id = bl_dep.booking_id AND bl_dep.leg_num = jb.min_leg\n  JOIN postgres_air.booking_leg bl_arr ON jb.booking_id = bl_arr.booking_id AND bl_arr.leg_num = jb.max_leg\n  JOIN postgres_air.flight f_dep ON bl_dep.flight_id = f_dep.flight_id\n  JOIN postgres_air.flight f_arr ON bl_arr.flight_id = f_arr.flight_id\n),\nqualified_booking AS (\n  SELECT fl.booking_id\n  FROM first_last fl\n  JOIN postgres_air.airport a_dep ON fl.departure_airport = a_dep.airport_code\n  JOIN postgres_air.airport a_arr ON fl.arrival_airport = a_arr.airport_code\n  WHERE a_dep.continent = 'AS' AND a_arr.continent = 'SA'\n)\nSELECT AVG(EXTRACT(EPOCH FROM (f2.scheduled_departure - f1.scheduled_arrival))/60) AS avg_connection_time_minutes\nFROM postgres_air.booking_leg bl1\nJOIN postgres_air.booking_leg bl2 ON bl1.booking_id = bl2.booking_id AND bl2.leg_num = bl1.leg_num + 1\nJOIN postgres_air.flight f1 ON bl1.flight_id = f1.flight_id\nJOIN postgres_air.flight f2 ON bl2.flight_id = f2.flight_id\nWHERE bl1.booking_id IN (SELECT booking_id FROM qualified_booking);"
}